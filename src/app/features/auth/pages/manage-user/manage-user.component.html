<div class="manage-user-container">
  <h1>ユーザー詳細</h1>
  <table class="user-detail-table">
    <tr>
      <th>会社ID</th>
      <td>{{ companyId }}</td>
    </tr>
    <tr>
      <th>会社名</th>
      <td>{{ companyName }}</td>
    </tr>
    <tr>
      <th>ユーザー名</th>
      <td>{{ userName }}</td>
    </tr>
    <tr>
      <th>メールアドレス</th>
      <td>{{ email }}</td>
    </tr>
    <tr>
      <th>管理権限</th>
      <td>{{ role }}</td>
    </tr>
    <tr>
      <th>Google認証</th>
      <td>
        <button (click)="showPasswordInput = true" *ngIf="!isGoogleLinked && !showPasswordInput">Google認証を有効にする</button>
        <span *ngIf="isGoogleLinked" style="color: #1976d2;">Google認証連携済み</span>
        <div *ngIf="showPasswordInput">
          <label style="display:block; margin-bottom:4px;">現在のパスワードを入力してください</label>
          <input type="password" [(ngModel)]="inputPassword" style="margin-right:8px;">
          <button (click)="onLinkGoogleWithPassword()">連携する</button>
          <button (click)="showPasswordInput = false">キャンセル</button>
        </div>
      </td>
    </tr>
    <tr>
      <th>パスワード変更</th>
      <td>
        <button style="margin-left: 10px;" (click)="showPasswordModal = true">パスワード変更</button>
      </td>
    </tr>
  </table>

  <!-- パスワード変更モーダル -->
  <div *ngIf="showPasswordModal" class="modal-overlay">
    <div class="modal-content" style="min-width:320px;max-width:90vw;position:relative;">
      <h3>パスワード変更</h3>
      <button class="modal-close" (click)="showPasswordModal = false">×</button>
      <form (ngSubmit)="onChangePassword()">
        <div style="margin-bottom:1em;">
          <label>現在のパスワード</label><br>
          <input type="password" [(ngModel)]="currentPassword" name="currentPassword" required style="width:100%;padding:0.5em;">
        </div>
        <div style="margin-bottom:1em;">
          <label>新しいパスワード</label><br>
          <input type="password" [(ngModel)]="newPassword" name="newPassword" required style="width:100%;padding:0.5em;">
        </div>
        <div style="text-align:right;">
          <button type="button" (click)="showPasswordModal = false" style="margin-right:1em;">キャンセル</button>
          <button type="submit">変更</button>
        </div>
      </form>
    </div>
  </div>
</div>
