<form [formGroup]="form" (ngSubmit)="onSubmit()" class="employee-form">
  <mat-accordion>
    <!-- 基本情報 -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>基本情報</mat-panel-title>
      </mat-expansion-panel-header>
      <div class="form-grid">
        <div class="form-row">
          <label>姓 <span class="required">*</span></label>
          <input formControlName="lastName" required />
          <div *ngIf="form.get('lastName')?.invalid && form.get('lastName')?.touched" class="error">姓は必須です</div>
        </div>
        <div class="form-row">
          <label>名 <span class="required">*</span></label>
          <input formControlName="firstName" required />
          <div *ngIf="form.get('firstName')?.invalid && form.get('firstName')?.touched" class="error">名は必須です</div>
        </div>
        <div class="form-row">
          <label>マイナンバー <span class="required">*</span></label>
          <input formControlName="myNumber" maxlength="12" required />
          <div *ngIf="form.get('myNumber')?.invalid && form.get('myNumber')?.touched" class="error">12桁の数字で入力してください</div>
        </div>
        <div class="form-row">
          <label>
            姓（カナ）
            <input formControlName="lastNameKana" />
          </label>
          <label>
            名（カナ）
            <input formControlName="firstNameKana" />
          </label>
        </div>
        <div class="form-row">
          <label>
            生年月日
            <input type="date" formControlName="birthday" />
          </label>
          <label>
            性別
            <select formControlName="gender">
              <option value="">選択してください</option>
              <option *ngFor="let g of genderTypes" [value]="g.code">{{ g.name }}</option>
            </select>
          </label>
          <label>
            従業員ID
            <input formControlName="employeeId" />
          </label>
        </div>
      </div>
    </mat-expansion-panel>

    <!-- 雇用情報 -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>雇用情報</mat-panel-title>
      </mat-expansion-panel-header>
      <div class="form-grid">
        <div class="form-row">
          <label>事業所名</label>
          <input formControlName="officeName" />
        </div>
        <div class="form-row">
          <label>部署</label>
          <input formControlName="department" />
        </div>
        <div class="form-row">
          <label>役職</label>
          <input formControlName="position" />
        </div>
        <div class="form-row">
          <label>雇用形態</label>
          <select formControlName="employeeType">
            <option value="">選択してください</option>
            <option *ngFor="let t of employeeTypes" [value]="t.code">{{ t.name }}</option>
          </select>
        </div>
        <div class="form-row">
          <label>勤務形態</label>
          <select formControlName="workStyle">
            <option value="">選択してください</option>
            <option *ngFor="let t of workStyleTypes" [value]="t.code">{{ t.name }}</option>
          </select>
        </div>
        <div class="form-row">
          <label>雇用日</label>
          <input type="date" formControlName="hireDate" />
        </div>
        <div class="form-row">
          <label>契約開始日</label>
          <input type="date" formControlName="contractStartDate" />
        </div>
        <div class="form-row">
          <label>契約終了日</label>
          <input type="date" formControlName="contractEndDate" />
        </div>
        <div class="form-row">
          <label>退職日</label>
          <input type="date" formControlName="resignationDate" />
        </div>
        <div class="form-row">
          <label>退職理由</label>
          <input formControlName="resignationReason" />
        </div>
      </div>
    </mat-expansion-panel>

    <!-- 連絡先 -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>連絡先</mat-panel-title>
      </mat-expansion-panel-header>
      <div class="form-grid">
        <div class="form-row">
          <label>Email <span class="required">*</span></label>
          <input formControlName="email" required />
          <div *ngIf="form.get('email')?.invalid && form.get('email')?.touched" class="error">正しいメールアドレスを入力してください</div>
        </div>
        <div class="form-row">
          <label>電話番号</label>
          <input formControlName="phoneNumber" />
        </div>
        <div formGroupName="address">
          <div class="form-row">
            <label>郵便番号</label>
            <input formControlName="postalCode" />
          </div>
          <div class="form-row">
            <label>都道府県</label>
            <input formControlName="prefecture" />
          </div>
          <div class="form-row">
            <label>市区町村</label>
            <input formControlName="city" />
          </div>
          <div class="form-row">
            <label>町域・番地</label>
            <input formControlName="town" />
          </div>
          <div class="form-row">
            <label>建物名</label>
            <input formControlName="streetAddress" />
          </div>
        </div>
      </div>
    </mat-expansion-panel>

    <!-- 社会保険情報 -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>社会保険情報</mat-panel-title>
      </mat-expansion-panel-header>
      <div class="form-grid">
        <div class="form-row">
          <label>健康保険被保険者番号</label>
          <input formControlName="healthInsuranceNumber" />
        </div>
        <div class="form-row">
          <label>厚生年金被保険者番号</label>
          <input formControlName="pensionNumber" />
        </div>
        <div class="form-row">
          <label>雇用保険被保険者番号</label>
          <input formControlName="employmentInsuranceNumber" />
        </div>
        <div class="form-row">
          <label><input type="checkbox" formControlName="isHealthInsuranceApplicable" /> 健康保険適用</label>
        </div>
        <div class="form-row">
          <label><input type="checkbox" formControlName="isPensionApplicable" /> 厚生年金適用</label>
        </div>
        <div class="form-row">
          <label><input type="checkbox" formControlName="isCareInsuranceApplicable" /> 介護保険適用</label>
        </div>
      </div>
    </mat-expansion-panel>

    <!-- 緊急連絡先と扶養 -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>緊急連絡先と扶養</mat-panel-title>
      </mat-expansion-panel-header>
      <div class="form-grid">
        <div class="form-row">
          <label>氏名</label>
          <input formControlName="emergencyContactName" />
        </div>
        <div class="form-row">
          <label>電話番号</label>
          <input formControlName="emergencyContactPhone" />
        </div>
        <div formArrayName="dependents" style="grid-column: 1 / -1;">
          <div *ngFor="let dep of dependents.controls; let i = index" [formGroupName]="i" class="form-row">
            <label>氏名 <span class="required">*</span></label>
            <input formControlName="name" required />
            <label>続柄 <span class="required">*</span></label>
            <input formControlName="relation" required />
            <button type="button" (click)="removeDependent(i)">削除</button>
          </div>
          <button type="button" (click)="addDependent()">扶養家族を追加</button>
        </div>
      </div>
    </mat-expansion-panel>

    <!-- その他 -->
    <mat-expansion-panel>
      <mat-expansion-panel-header>
        <mat-panel-title>その他</mat-panel-title>
      </mat-expansion-panel-header>
      <div class="form-grid">
        <div class="form-row">
          <label>備考</label>
          <textarea formControlName="remarks"></textarea>
        </div>
      </div>
    </mat-expansion-panel>
  </mat-accordion>
  <div class="form-actions">
    <button type="submit" [disabled]="form.invalid">登録</button>
  </div>
</form>
