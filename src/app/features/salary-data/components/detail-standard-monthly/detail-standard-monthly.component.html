<h2>標準報酬月額 詳細</h2>

<!-- プロフィールカード -->
<div class="profile-card">
  <div class="avatar">{{ employeeInfo.lastName[0] }}{{ employeeInfo.firstName[0] }}</div>
  <div class="profile-main">
    <div class="name">{{ employeeInfo.lastName }} {{ employeeInfo.firstName }}</div>
    <div class="id">従業員番号: {{ employeeInfo.employeeId }}</div>
    <div class="office">{{ employeeInfo.officeName }}</div>
    <div class="birth">生年月日: {{ employeeInfo.birthday | date:'yyyy-MM-dd' }}</div>
    <div class="contract">契約開始日: {{ employeeInfo.contractStartDate || 'ー' }}</div>
  </div>
</div>

<!-- 保険適用状況 -->
<div class="insurance-status-row">
  <div class="insurance-card" [class.active]="employeeInfo.healthInsuranceStatus?.isApplicable">
    <span class="icon health"></span> 健康保険
  </div>
  <div class="insurance-card" [class.active]="employeeInfo.pensionStatus?.isApplicable">
    <span class="icon pension"></span> 厚生年金
  </div>
  <div class="insurance-card" [class.active]="employeeInfo.isCareInsuranceApplicable">
    <span class="icon care"></span> 介護保険
  </div>
</div>

<!-- 等級カード -->
<div class="grade-cards">
  <div class="grade-card current">
    <h3>現在適用中の等級</h3>
    <ng-container *ngIf="currentDecision; else noCurrent">
      <div>等級: {{ currentDecision.healthGrade }}（{{ currentDecision.pensionGrade }}）</div>
      <div>月額: {{ currentDecision.healthMonthly | currency:'JPY':'symbol':'1.0-0' }}（{{ currentDecision.pensionMonthly | currency:'JPY':'symbol':'1.0-0' }}）</div>
      <div>適用年月: {{ currentDecision.applyYearMonth }}</div>
      <div>登録種別: {{ getLabel(currentDecision.type) }}</div>
      <div>算出根拠: 4月給与: {{ currentDecision.aprilSalary ?? 'ー' }}, 5月給与: {{ currentDecision.maySalary ?? 'ー' }}, 6月給与: {{ currentDecision.juneSalary ?? 'ー' }}, 対象月: {{ currentDecision.usedMonths ?? 'ー' }}</div>
    </ng-container>
    <ng-template #noCurrent><div>該当なし</div></ng-template>
  </div>
  <div class="grade-card next">
    <h3>今後適用予定の等級</h3>
    <ng-container *ngIf="nextDecision; else noNext">
      <div>等級: {{ nextDecision.healthGrade }}（{{ nextDecision.pensionGrade }}）</div>
      <div>月額: {{ nextDecision.healthMonthly | currency:'JPY':'symbol':'1.0-0' }}（{{ nextDecision.pensionMonthly | currency:'JPY':'symbol':'1.0-0' }}）</div>
      <div>適用年月: {{ nextDecision.applyYearMonth }}</div>
      <div>登録種別: {{ getLabel(nextDecision.type) }}</div>
      <div>算出根拠: 4月給与: {{ nextDecision.aprilSalary ?? 'ー' }}, 5月給与: {{ nextDecision.maySalary ?? 'ー' }}, 6月給与: {{ nextDecision.juneSalary ?? 'ー' }}, 対象月: {{ nextDecision.usedMonths ?? 'ー' }}</div>
    </ng-container>
    <ng-template #noNext><div>該当なし</div></ng-template>
  </div>
</div>

<!-- 登録履歴テーブル -->
<div class="history-table">
  <h3>登録履歴</h3>
  <table *ngIf="decisions.length > 0">
    <thead>
      <tr>
        <th>適用年月</th>
        <th>等級</th>
        <th>月額</th>
        <th>登録種別</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let d of decisions">
        <td>{{ d.applyYearMonth }}</td>
        <td>{{ d.healthGrade }}（{{ d.pensionGrade }}）</td>
        <td>{{ d.healthMonthly | currency:'JPY':'symbol':'1.0-0' }}（{{ d.pensionMonthly | currency:'JPY':'symbol':'1.0-0' }}）</td>
        <td>{{ getLabel(d.type) }}</td>
      </tr>
    </tbody>
  </table>
  <div *ngIf="decisions.length === 0">履歴なし</div>
</div>
